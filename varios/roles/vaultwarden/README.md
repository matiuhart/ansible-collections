Role Name
=========

This role deploys the Vaultwarden password manager solution of dani-garcia

https://github.com/dani-garcia/vaultwarden

Requirements
------------

As base requirements you need docker, docker-compose installed and some reverse proxy with SSL enabled forwarding the traffic to the container port (5001)

Role Variables
--------------

| Variable | Default Value | Requeried |
| ----------- | ----------- | -------- |
| vw_install_path | /opt/vaultwarden | no |
| vw_admin_token | null | no |
| vw_smtp_host | null | no |
| vw_smtp_port | 465 | no |
| vw_smtp_security | force_tls | no |
| vw_smtp_from_name | null | no |
| vw_smtp_from_email | null | no |
| vw_smtp_from_user | null | no |
| vw_smtp_from_user_password | null | no |

Example Playbook
----------------
In this example, I have defined the `vw_admin_token` variable with an argon2 hash but you can leave this variable undefined (while the first run), the playbook will generate a random admin token, hashing it with argon2 and save the values autogenerated passwords in a txt file in `{{ vw_install_path }}/vw_admin_auto_generated_token.txt`. After this first run, you can copy the `Admin Argon2 hashed token` value and give the value for the `vw_admin_token` variable in the playbook variables definition. It's important to define this value because the playbook will check it and, if has not been set will generate it again.
Also, if you desire it can put any value of argon2 hash or in text plane  format

```
- name: Administrar instancia test
  hosts: ansible-tests
  become: true
  connection: ssh
  gather_facts: true
  vars:
    vw_install_path: "/home/docker/vaultwarden"
    vw_smtp_host: "smtp.gmail.com"
    vw_smtp_port: "465"
    vw_smtp_security: "force_tls"
    vw_smtp_from_name: "Vaultwarden Ansible Deployment"
    vw_smtp_from_email: "youruser@youremail.com"
    vw_smtp_from_user: "youruser@youremail.com"
    vw_smtp_from_user_password: "yoursuperpassword"

  roles:
    - vaultwarden
```

After first run I copied the argon2 hash from `{{ vw_install_path }}/vw_admin_auto_generated_token.txt` and I have added this variable to the playbook:
`vw_admin_token: "$$argon2id$$v=19$$m=65540,t=3,p=4$$JChvcGVuc3NsIHJhbmQgLWJhc2U2NCAzMik$$A69g5MLOxBDB6HLiEH6u4y1LxMugXs66wdoqkb59ASk" `


Author Information
------------------
This is a role created by matiuhart if you want to check some of my collections:

https://github.com/matiuhart/ansible-collections
